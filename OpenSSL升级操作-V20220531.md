## OpenSSL升级操作

1.确认当前的openssl版本

```shell
openssl version -a
--
# 输出信息如下：
OpenSSL 1.0.2k  26 Jan 2017
built on: reproducible build, date unspecified
platform: linux-x86_64
options:  bn(64,64) rc4(16x,int) des(idx,cisc,16,int) idea(int) blowfish(idx) 
compiler: gcc -I. -I.. -I../include  -fPIC -DOPENSSL_PIC -DOPENSSL_THREADS -D_REENTRANT -DDSO_DLFCN -DHAVE_DLFCN_H -Wa,--noexecstack -m64 -DL_ENDIAN -O3 -Wall -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_BN_ASM_GF2m -DRC4_ASM -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DMD5_ASM -DAES_ASM -DVPAES_ASM -DBSAES_ASM -DWHIRLPOOL_ASM -DGHASH_ASM -DECP_NISTZ256_ASM
OPENSSLDIR: "/opt/py36/openssl"

# 可见当前OpenSSL版本为 1.0.2k
```

2.升级OpenSSL准备工作

```shell
# 1.安装需要组件包
yum install -y  zlib zlib-devel gcc gcc-c++ perl

# 2.下载openssl最新源码包
cd /root/
wget https://github.com/openssl/openssl/archive/refs/tags/OpenSSL_1_1_1o.tar.gz
```

3.升级OpenSSL

```shell
cd /root
tar xf OpenSSL_1_1_1o.tar.gz
cd OpenSSL_1_1_1o
./config 
echo $?
---
# 如果输出为0，表示上面的命令执行成功
make && make install 
echo $?
# 如果输出为0，表示上面的命令执行成功
```

4.配置升级后的OpenSSL

```shell
# 备份OpenSSL
mv /opt/py36/bin/openssl /opt/py36/bin/openssl.ori

# 创建新OpenSSL软连接
ln -s /usr/local/bin/openssl /opt/py36/bin/openssl

#将新的库文件地址写入记录so库的配置文件
echo "/usr/local/lib64" >> /etc/ld.so.conf  

#设置生效
ldconfig -v
```

5.验证OpenSSL

```shell
# 确认OpenSSL PATH路径
[root@bk1 ~]# which  openssl
/opt/py36/bin/openssl

# 确认OpenSSL 最新版本
[root@bk1 ~]# openssl version -a
OpenSSL 1.1.1o  3 May 2022
built on: Tue May 31 11:39:13 2022 UTC
platform: linux-x86_64
options:  bn(64,64) rc4(16x,int) des(int) idea(int) blowfish(ptr) 
compiler: gcc -fPIC -pthread -m64 -Wa,--noexecstack -Wall -O3 -DOPENSSL_USE_NODELETE -DL_ENDIAN -DOPENSSL_PIC -DOPENSSL_CPUID_OBJ -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_BN_ASM_GF2m -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DKECCAK1600_ASM -DRC4_ASM -DMD5_ASM -DAESNI_ASM -DVPAES_ASM -DGHASH_ASM -DECP_NISTZ256_ASM -DX25519_ASM -DPOLY1305_ASM -DNDEBUG
OPENSSLDIR: "/usr/local/ssl"
ENGINESDIR: "/usr/local/lib64/engines-1.1"
Seeding source: os-specific
```

