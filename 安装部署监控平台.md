## 安装部署增强版套餐

### 1.第一种方式后台安装

+ 首先下载安装包，放到/data/install/src/saas里

   + ![cp install.config.3ip.sample  install.config](http://xwyhhhh1.test.upcdn.net/image-20220215224634936.png)

+ 然后回到install目录，执行./bk_install bkmonitorv3执行安装，这里可能会出现time out的 报错，解决办法如下

   > 此种方法仅仅适用于，install.config文件是拷贝的cp install.config.3ip.sample  install.config

   + ```shell
      # 查询appo或者appt在哪一台主机节点上
      egrep 'app(o|t)' /data/install/install.config 
      ```

   + ```shell
      # 修改配置文件
      vim /data/bkce/paas_agent/paas_agent/etc/paas_agent_config.yaml
      EXECUTE_TIME_LIMIT=3000
      ```

   + ```shell
      # 查看paas安装节点
      grep paas /data/install/install.config
      # 添加配置项
      vim /data/bkce/open_paas/paas/conf/settings_production.py
      EVENT_STATE_EXPIRE_SECONDS = 3600
      ```

   + ```shell
      # 回到中控机上的/data/install/目录
      ./bkce resatrt paas
      ./bkce restart app
      ```

### 2.标准运维安装

+ 还是首先下载压缩包，额外的还要多下载一个标准运维模板
   + ![image-20220215230047743](http://xwyhhhh1.test.upcdn.net/image-20220215230047743.png)

+ 如上图所示需要导入，导入完成之后点击如图所示
   + ![](http://xwyhhhh1.test.upcdn.net/image-20220215230314901.png)

+ 创建任务，填写参数
   + ![image-20220215230434649](http://xwyhhhh1.test.upcdn.net/image-20220215230434649.png)

+ 会出现流程图，点击右上方的运行即可，报错time out参考上面

### 3.在蓝鲸paas平台上部署

+ 点击开发者中心，选择s-mart，选择点击上传，完毕之后，点击开始部署，建议先在测试环境安装，之后在正式环境安装

### 4.注意事项

+ 新加入得主机应该配置免密项，并且安装agent节点，不是新加入的也要注意agent节点是否部署。
+ 后台安装依赖于服务es7，这个服务有个特性，他会分出你最大内存的一半作为启动内存，所以建议在内存剩余较多的主机安装

### 5.日志地址

```shell
# 首先要查找appo在哪台机器上
grep "appo" /data/install/install.config
# 进入哪台机器
# 此为前端所产生的日志数据
cd /data/bkce/pass_agent/logs/apps/bk_bkmonitorv3 
# 服务端在中控机上
cd /data/bkce/logs/bkmonitorv3
```

