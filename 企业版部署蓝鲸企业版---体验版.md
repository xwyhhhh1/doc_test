## 企业版部署蓝鲸企业版---体验版

```bash
10.1.1.245 
license,consul,appo,beanstalk,monitorv3(influxdb-proxy),influxdb(bkmonitorv3),ssm,es7,mongodb,gse,redis,usermgr
10.1.1.34 
license,consul,paas,cmdb,beanstalk,monitorv3(influxdb-proxy),monitorv3(monitor),mysql,gse,redis,rabbitmq,appo,monitorv3(unify-query)
10.1.1.161 :nginx,zk(config),redis_sentinel,kafka(config),fta,iam,paas,mongodb,monitorv3(transfer),monitorv3(monitor),log(api),log(grafana)
10.1.1.155 nginx,zk(config),redis_sentinel,kafka(config),fta,nfs,influxdb(bkmonitorv3),usermgr,log(api),monitorv3(transfer),job,iam,es7
10.1.1.56 cmdb,job,zk(config),kafka(config),rabbitmq,consul,redis_sentinel,ssm,nodeman(nodeman),monitorv3(grafana),es7,mongodb,appt

```



### 1.consul

- 已知蓝鲸企业版也是通过consul发现各服务器的服务，因此consul服务应每台机器都有。

- 假如有服务已经启动可是却出现无法提供服务的状态，**查看consul的状态是个不错的思路**
- 另外，consul是基于http api和dns来进行发现和寻找服务的动作，dns解析文件如果出了问题就会导致consul无法辨识主机，造成问题，因此在确定consul正常的状态下，如果服务依然出现问题，比如nginx提供网页服务，但是访问不到网页，nginx进程和状态依然并无太大问题，**这个时候建议查看dns解析文件**，如果乱码或者缺失配置，这证明consul无法辩证这台主机，服务无法被发现，无法正确的把服务资源引导到其它主机。

> 因此consul在蓝鲸中应当是指路人的角色，如果consul挂掉，蓝鲸整体都会无法访问。（假设）

### 2.license

> license由机器mac地址生成的证书包解压而来，license主要作用为使用蓝鲸软件需要进行鉴权，判断蓝鲸是否为正版（大概）

- license为证书服务，由证书包解压而来，证书包一般为bkce_cert*

- license企业版测试环境为两台，正式环境应看部署规模来申请license
- 主要是mac地址

### 3.beanstalk

- 亚马逊给出的解释是
  - 用于在熟悉的服务器（例如 Apache 、Nginx、Passenger 和 IIS ）上部署和扩展使用 Java、.NET、PHP、Node.js、Python、Ruby、GO 和 Docker 开发的 Web 应用程序和服务。
- 由此可知beanstalk是部署扩展web服务的，因此beanstalk应该与nginx、appo连用，beanstalk依赖于appo,appo服务机器管控着docker

### monitorv3(influxdb-proxy)

- 监控平台的数据转发组件，一般为kafka
- 采集器或者采集插件获取到数据之后，会向上到当前的influxdb库中，由kafka同步数据
