## 电信通创安全基线可用资料整理

### 1. 10.10.9.31 

+ nginx的配置

  + ```shell
    ps -aux | grep nginx
    #进入nginx安装地址主配置文件所在地
    cd /usr/local/openresty/nginx/conf
    vim /nginx.comf
    在server中添加error_page 400 413 404 502 504 /50x.html
    ```

+ 限制客户端的下载速度

  + ```shell
    在nginx配置文件的server中添加
    limit_conn addr 5; #是限制每个IP只能发起5个连接
    limit_rate 100k; #限速为 100KB/秒
    ```

+ 控制超时时间

  + ```shell
    在nginx配置文件的server中添加
    client_header_timeout 15;     
    client_body_timeout 15;     
    send_timeout 25;
    ```

+ 配置登录时间超市时间设置

  + ```shell
    vim /etc/profile
    添加全局变量export TMOUT=900
    source /etc/profile
    ```

+ 限制root用户远程登录

  + ```shell
    vim /etc/ssh/sshd_config
    搜索PermitRootLogin配置
    改为no
    重启服务即可
    ```

+ 设置密码过期时间

  + ```shell
    vim  /etc/login.defs
    PASS_MAX_DAYS 60      #密码最大有效期，此处参数PASS_MAX_DAYS为60，表示60天后，密码会过期。99999表示永不过期。PASS_MIN_DAYS 0      #两次修改密码的最小间隔时间，0表示可以随时修改账号密码PASS_MIN_LEN  8      #密码最小长度，对于root无效PASS_WARN_AGE 7      #密码过期前多少天开始提示
    ```

+ 设置配置密码复杂程度

  + ```shell
    vim /etc/pam.d/system-auth
    password requisite pam_cracklib.so retry=5 difok=3 minlen=8 dcredit=-3 ucredit=-2 lcredit=-4 ocredit=-1 dictpath=/usr/share/cracklib/pw_dict
    
    
    # 修改密码，可以重试的次数
    retry=5
    # 与旧密码不同的字符个数
    difok=3
    # 新密码最小长度
    minlen=8
    # 数字个数。大于0，最多；小于0，最少
    dcredit=-3
    # 大写字母个数。大于0，最多；小于0，最少
    ucredit=-2
    # 小写字母个数。大于0，最多；小于0，最少
    lcredit=-4
    # 特殊字符个数。大于0，最多；小于0，最少
    ocredit=-1
    
    ```

+ 限制普通用户su到root

  ```shell
  去除/etc/pam.d/su文件中如下行的注释：
  #auth            required        pam_wheel.so use_uid
  在／etc/login.defs文件中加入如下配置项：
  SU_WHEEL_ONLY yes
  
  经过上述配置后，普通用户将被禁止su至root，如果希望指定普通用户su至root，可以执行如下命令将该用户添加至wheel组中：
  usermod -G wheel bk
  usermod -G wheel blueking
  ```

  启用远程日志功能

  + ```shell
    vim /etc/rsyslog.conf
    //将以下两行的注释符去除
    #$ModLoad imtcp
    #$InputTCPServerRun 514
    [root@xuexi ~]# systemctl restart rsyslog.service　　//重启服务
    [root@xuexi ~]# netstat -anlpt | grep 514　　//查看是否开启，查看是否存在514端口
    tcp        0      0 0.0.0.0:514             0.0.0.0:*               LISTEN      9708/rsyslogd
    tcp6       0      0 :::514                  :::*                    LISTEN      9708/rsyslogd
    
    ```

+ umask配置

  + ```shell
    更改该用户家目录下的配置文件：
    vi ~/.bashrc
    例如：
    umask 022
    然后执行命令：
    source ~/.bashrc使更改生效
    ```

